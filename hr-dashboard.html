<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="txt-title">ูุธุงู ุชูููู | ููุญุฉ ุชุญูู HR</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/hr-admin.css">
    
    <!-- ููุชุจุฉ ุงูุฑุณูู ุงูุจูุงููุฉ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- ููุชุจุงุช Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
</head>
<body>

    <header class="hr-header">
        <div class="header-main">
            <div class="header-right">
                <button onclick="location.href='home.html'" class="btn-back">
                    <span class="icon">โฌ</span> <span id="btn-back-txt">ุฑุฌูุน</span>
                </button>
                <div class="lang-toggle">
                    <span onclick="setLanguage('ar')">AR</span> | <span onclick="setLanguage('en')">EN</span>
                </div>
            </div>
            <h2 id="txt-header">ุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ - Tamkeen HR</h2>
        </div>
    </header>

    <main class="hr-content">
        
        <!-- ูุณู ุงูุฅุญุตุงุฆูุงุช -->
        <div class="stats-grid">
            <div class="stat-card total">
                <div class="stat-info"><p id="txt-total">ุฅุฌูุงูู ูุงูุฉ ุงูุทูุจุงุช</p><h3 id="total-count">0</h3></div>
                <div class="stat-icon">๐</div>
            </div>
            <div class="stat-card approved">
                <div class="stat-info"><p id="txt-approved">ุทูุจุงุช ุชูุช ุงูููุงููุฉ ุนูููุง</p><h3 id="approved-count">0</h3></div>
                <div class="stat-icon">โ</div>
            </div>
            <div class="stat-card actions">
                <button onclick="exportToExcel()" class="btn-export">๐ฅ Excel</button>
                <button onclick="deleteSelectedRequests()" id="btn-delete-multi" class="btn-bulk-delete" style="display:none;">๐๏ธ ุญุฐู ุงููุญุฏุฏ</button>
            </div>
        </div>

        <!-- ูุณู ุงูุฑุณูู ุงูุจูุงููุฉ -->
        <div class="charts-panel">
            <div class="chart-container"><h4 id="txt-chart-status">ุชูุฒูุน ุงูุญุงูุงุช</h4><canvas id="statusChart"></canvas></div>
            <div class="chart-container"><h4 id="txt-chart-dept">ุฃูุซุฑ ุงูุฃูุณุงู ุทูุจุงู</h4><canvas id="deptChart"></canvas></div>
        </div>

        <!-- ูุณู ุงูููุงุชุฑ ูุฑูุน CSV -->
        <div class="control-panel">
            <div class="upload-section">
                <h4 id="lbl-upload">ุชุญุฏูุซ ุงูููุธููู (CSV)</h4>
                <input type="file" id="csvFile" accept=".csv">
                <button onclick="uploadCSV()" class="btn-upload">ุจุฏุฃ ุงูุฑูุน</button>
            </div>
            <div class="filter-panel">
                <div class="filter-row">
                    <input type="date" id="filter-date-from" onchange="filterTable()">
                    <input type="date" id="filter-date-to" onchange="filterTable()">
                    <select id="filter-dept-dropdown" onchange="filterTable()"><option value="">ูู ุงูุฃูุณุงู</option></select>
                    <select id="filter-status" onchange="filterTable()">
                        <option value="">ูู ุงูุญุงูุงุช</option>
                        <option value="Approved">ููุจูู</option>
                        <option value="Pending">ูุนูู</option>
                        <option value="Rejected">ูุฑููุถ</option>
                    </select>
                    <input type="text" id="filter-general" onkeyup="filterTable()" placeholder="ุจุญุซ ุณุฑูุน...">
                    <button class="btn-reset" onclick="resetFilters()">๐</button>
                </div>
            </div>
        </div>

        <!-- ุฌุฏูู ุงูุจูุงูุงุช -->
        <div class="table-wrapper">
            <table id="requestsTable">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAll" onclick="toggleSelectAll()"></th>
                        <th id="th-code">ุงูููุฏ</th>
                        <th id="th-name">ุงูููุธู</th>
                        <th id="th-dept">ุงููุณู</th>
                        <th id="th-type">ุงูููุน</th>
                        <th id="th-dates">ุงูุชุงุฑูุฎ (ูู - ุฅูู)</th>
                        <th id="th-status">ุงูุญุงูุฉ</th>
                        <th id="th-action">ุฅุฌุฑุงุก</th>
                    </tr>
                </thead>
                <tbody id="hr-requests-table"></tbody>
            </table>
        </div>
    </main>

    <!-- ููุฏุงู ุงูุชูุงุตูู ุงูุดูู (Detailed Card) -->
    <div id="detailsModal" class="modal">
        <div class="modal-content animate-top">
            <div class="modal-header-pro">
                <h2 id="det-empName">ุชูุงุตูู ุงูุทูุจ</h2>
                <span class="close-modal" onclick="closeDetailsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="info-grid">
                    <div class="info-box"><strong>ููุฏ ุงูููุธู:</strong> <span id="det-code"></span></div>
                    <div class="info-box"><strong>ุงููุณู:</strong> <span id="det-dept"></span></div>
                    <div class="info-box"><strong>ููุน ุงูุทูุจ:</strong> <span id="det-type"></span></div>
                    <div class="info-box"><strong>ุงููุฏุฉ:</strong> <span id="det-dates"></span></div>
                </div>
                <div class="message-section">
                    <strong>๐ ุณุจุจ ุงูููุธู:</strong>
                    <p id="det-reason" class="msg-text"></p>
                </div>
                <div class="message-section manager-reply">
                    <strong>๐ฌ ุฑุฏ ุงููุฏูุฑ (ุงููุฑุงุฌุน):</strong>
                    <p id="det-manager-note" class="msg-text"></p>
                </div>
                <div id="det-attachment-area" class="attachment-box">
                    <!-- ุงููุฑูู ูุธูุฑ ููุง -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script src="js/lang-manager.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/hr-admin.js"></script>
</body>
</html>
